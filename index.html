<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Binomische Formeln â€“ Trainer</title>
<style>
  body{font-family:system-ui,Arial,sans-serif;margin:0;padding:20px;text-align:center;background:linear-gradient(to bottom right,#eef2ff,#e0f7fa)}
  h1{margin:10px 0;font-size:1.8em;color:#333}
  #task{font-size:1.6em;margin:15px auto;white-space:pre-line}
  #result{font-size:1.1em;margin:10px;color:#000}
  #score{margin:8px;color:#333}
  #levelDisplay{font-weight:bold;color:#007bff;margin-bottom:5px}
  #progressContainer{width:80%;max-width:400px;height:20px;background:#ddd;border-radius:10px;margin:10px auto 20px;overflow:hidden;display:flex}
  .progress-segment{flex:1;height:100%;transition:background-color .3s}
  input{padding:10px;font-size:1.2em;width:80%;max-width:300px;text-align:center;border-radius:8px;border:1px solid #aaa}
  input:focus{outline:none;border-color:#007bff}
  button{background:#007bff;color:white;border:none;padding:10px 18px;margin:6px;border-radius:8px;cursor:pointer}
  button:hover{background:#0056b3}
</style>
</head>
<body>
<h1>Trainer â€“ 3 binomische Formeln</h1>
<div id="levelDisplay">Level 1: Nur Variablen</div>
<div id="score">Lade...</div>
<div id="progressContainer"></div>
<div id="task">...</div>
<input id="answer" placeholder="LÃ¶sung eingeben" autocomplete="off" spellcheck="false">
<br>
<button id="checkBtn">PrÃ¼fen</button>
<button id="newBtn">Neue Aufgabe</button>
<p id="result"></p>

<script>
document.addEventListener("DOMContentLoaded",()=>{

  const answerEl=document.getElementById("answer");
  const checkBtn=document.getElementById("checkBtn");
  const newBtn=document.getElementById("newBtn");
  const taskEl=document.getElementById("task");
  const resultEl=document.getElementById("result");
  const scoreEl=document.getElementById("score");
  const levelDisplay=document.getElementById("levelDisplay");
  const progressContainer=document.getElementById("progressContainer");

  const VARS=['a','b','c','x','y','u','v'];
  const rc=a=>a[Math.floor(Math.random()*a.length)];

  const LEVEL_NAMES=[
    "Level 1: Nur Variablen",
    "Level 2: Zahl und Variable",
    "Level 3: (ax + by)-Terme"
  ];

  const fixedHints={
    1:"(a + b)Â² = aÂ² + 2ab + bÂ²\n(a - b)Â² = aÂ² - 2ab + bÂ²\n(a + b)(a - b) = aÂ² - bÂ²",
    2:" Sieh die Variable als a und die Zahl als b.\nBeispiel: (x + 3)Â² = xÂ² + 6x + 9",
    3:"(ax + by)Â² = aÂ²xÂ² + 2abxy + bÂ²yÂ²\n(ax + by)(ax - by) = aÂ²xÂ² - bÂ²yÂ²"
  };

  function norm(s){
    return s
      .replace(/\s+/g,'')
      .replace(/Â·/g,'*')
      .replace(/Â²/g,'^2')
      .toLowerCase();
  }

  let level=1, MAX_LEVEL=3;
  let correctSolution="";
  let round=1, score=0, totalRounds=10;
  let segments=[];

  function initProgressBar(){
    progressContainer.innerHTML="";
    segments=[];
    for(let i=0;i<totalRounds;i++){
      const d=document.createElement("div");
      d.className="progress-segment";
      d.style.background="#ddd";
      progressContainer.appendChild(d);
      segments.push(d);
    }
  }

  function updateHeader(){
    levelDisplay.textContent=LEVEL_NAMES[level-1];
    scoreEl.textContent=`Aufgabe ${Math.min(round,totalRounds)} von ${totalRounds} â€“ Punkte: ${score}`;
  }

  // Level 1: Variablen
  function createLevel1Task(){
    let a=rc(VARS), b=rc(VARS);
    while(a===b) b=rc(VARS);
    let mid=[a,b].sort().join("");
    let t=Math.floor(Math.random()*3);

    if(t===0){
      correctSolution=`${a}Â²+2${mid}+${b}Â²`;
      return `(${a} + ${b})Â² = ?`;
    }
    if(t===1){
      correctSolution=`${a}Â²-2${mid}+${b}Â²`;
      return `(${a} - ${b})Â² = ?`;
    }
    correctSolution=`${a}Â²-${b}Â²`;
    return `(${a} + ${b}) Â· (${a} - ${b}) = ?`;
  }

  // Level 2: Zahl + Variable
  function createLevel2Task(){
    let v=rc(VARS);
    let n=Math.floor(Math.random()*6)+2;
    let t=Math.floor(Math.random()*5);

    if(t===0){
      correctSolution=`${v}Â²+${2*n}${v}+${n*n}`;
      return `(${v} + ${n})Â² = ?`;
    }
    if(t===1){
      correctSolution=`${v}Â²+${2*n}${v}+${n*n}`;
      return `(${n} + ${v})Â² = ?`;
    }
    if(t===2){
      correctSolution=`${v}Â²-${2*n}${v}+${n*n}`;
      return `(${v} - ${n})Â² = ?`;
    }
    if(t===3){
      correctSolution=`${v}Â²-${2*n}${v}+${n*n}`;
      return `(${n} - ${v})Â² = ?`;
    }
    correctSolution=`${v}Â²-${n*n}`;
    return `(${v} + ${n}) Â· (${v} - ${n}) = ?`;
  }

  // Level 3: (ax + by)-Terme
  function createLevel3Task(){
    let v1=rc(VARS), v2=rc(VARS);
    while(v1===v2) v2=rc(VARS);
    let a=Math.floor(Math.random()*4)+2;
    let b=Math.floor(Math.random()*4)+2;
    let mid=[v1,v2].sort().join("");

    let t=Math.floor(Math.random()*3);

    if(t===0){
      correctSolution=`${a*a}${v1}Â²+${2*a*b}${mid}+${b*b}${v2}Â²`;
      return `(${a}${v1} + ${b}${v2})Â² = ?`;
    }
    if(t===1){
      correctSolution=`${a*a}${v1}Â²-${2*a*b}${mid}+${b*b}${v2}Â²`;
      return `(${a}${v1} - ${b}${v2})Â² = ?`;
    }
    correctSolution=`${a*a}${v1}Â²-${b*b}${v2}Â²`;
    return `(${a}${v1} + ${b}${v2}) Â· (${a}${v1} - ${b}${v2}) = ?`;
  }

  function finishLevel(){
    if(score>=8 && level<MAX_LEVEL){
      alert(`Level ${level} geschafft!`);
      level++;
    } else if(score>=8){
      alert("Alle Level geschafft! ğŸ‰");
    } else {
      alert(`Level ${level} beendet mit ${score} Punkten.`);
    }

    round=1; score=0;
    segments.forEach(s=>s.style.background="#ddd");
    updateHeader();
    newTask();
  }

  function newTask(){
    resultEl.textContent="";
    answerEl.value="";

    if(round>totalRounds){
      finishLevel();
      return;
    }

    updateHeader();

    if(level===1) taskEl.textContent=createLevel1Task();
    else if(level===2) taskEl.textContent=createLevel2Task();
    else taskEl.textContent=createLevel3Task();
  }

  function checkAnswer(){
    if(!answerEl.value.trim()) return;

    let input=norm(answerEl.value);
    let sol=norm(correctSolution);

    if(input===sol){
      segments[round-1].style.background="#4caf50";
      score++;
      resultEl.style.color="green";
      resultEl.textContent="Richtig!";
    } else {
      segments[round-1].style.background="#d9534f";
      resultEl.style.color="black";
      resultEl.innerHTML=`âŒ Falsch! Richtige LÃ¶sung: <b>${correctSolution}</b><br><br><b>Hinweis:</b><br>${fixedHints[level].replace(/\n/g,"<br>")}`;
    }

    round++;
    updateHeader();
  }

  checkBtn.onclick=checkAnswer;
  newBtn.onclick=newTask;
  answerEl.addEventListener("keydown",e=>{if(e.key==="Enter") checkAnswer();});

  initProgressBar();
  updateHeader();
  newTask();
});
</script>
</body>
</html>





