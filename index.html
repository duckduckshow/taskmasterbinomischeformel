<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Trainer ‚Äì 3 binomische Formeln</title>
<style>
  body {
    font-family: system-ui, Arial, sans-serif;
    background: linear-gradient(to bottom right,#f0f4ff,#e0f7fa);
    text-align: center;
    margin: 0;
    padding: 20px;
  }
  h1 { color:#333; margin:10px 0; font-size:1.8em; }
  #task { font-size:1.6em; margin:15px auto; white-space:pre-line; }
  #result { font-size:1.1em; margin:10px; color:#000; font-weight:400; }
  #score { font-size:1.1em; margin:8px; color:#333; }
  #levelDisplay { font-weight:bold; color:#007bff; margin-bottom:5px; }
  #progressContainer {
    width:80%; max-width:400px; height:20px;
    background-color:#ddd; border-radius:10px;
    margin:10px auto 20px; overflow:hidden;
    display:flex;
  }
  .progress-segment {
    height:100%;
    flex:1;
    transition:background-color 0.3s ease;
  }
  input {
    padding:10px; font-size:1.2em; width:80%; max-width:300px;
    text-align:center; border-radius:8px; border:1px solid #aaa;
  }
  input:focus { outline:none; border-color:#007bff; }
  button {
    background:#007bff; color:white; border:none;
    padding:10px 18px; margin:6px; font-size:1em;
    border-radius:8px; cursor:pointer;
  }
  button:hover { background:#0056b3; }
</style>
</head>
<body>
<h1>Trainer ‚Äì 3 binomische Formeln</h1>
<div id="levelDisplay">Level 1: Nur Variablen</div>
<div id="score">Lade...</div>
<div id="progressContainer"></div>
<div id="task">...</div>
<input type="text" id="answer" placeholder="Deine L√∂sung" autocomplete="off" spellcheck="false"><br>
<button id="checkBtn">Pr√ºfen</button>
<button id="newBtn">Neue Aufgabe</button>
<p id="result"></p>
<p style="font-size:0.8em;color:#555;margin-top:40px;">
Diese Seite speichert keine pers√∂nlichen Daten und l√§uft vollst√§ndig lokal im Browser.<br>
¬© 2025 Binomtrainer
</p>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const answerEl = document.getElementById("answer");
  const checkBtn = document.getElementById("checkBtn");
  const newBtn = document.getElementById("newBtn");
  const taskEl = document.getElementById("task");
  const resultEl = document.getElementById("result");
  const scoreEl = document.getElementById("score");
  const levelDisplay = document.getElementById("levelDisplay");
  const progressContainer = document.getElementById("progressContainer");

  const VARS = ['a','b','c','x','y','u','v'];
  const randomChoice = a => a[Math.floor(Math.random()*a.length)];
  const LEVEL_NAMES = [
    "Level 1: Nur Variablen",
    "Level 2: Zahl und Variable",
    "Level 3: (ax + by)-Terme"
  ];

  // feste Hinweise pro Level
  const fixedHints = {
    1: "Merke dir die drei binomischen Formeln:\n(a + b)¬≤ = a¬≤ + 2ab + b¬≤\n(a - b)¬≤ = a¬≤ - 2ab + b¬≤\n(a + b)(a - b) = a¬≤ - b¬≤",
    2: "Sieh die Variable als a und die Zahl als b.\nBeispiel: (x + 3)¬≤ ‚Üí a = x, b = 3.\nDann: a¬≤ + 2ab + b¬≤ = x¬≤ + 6x + 9.",
    3: "Bei (ax + by)¬≤ gilt:\n(a¬∑x + b¬∑y)¬≤ = a¬≤x¬≤ + 2abxy + b¬≤y¬≤\nund (ax + by)(ax - by) = a¬≤x¬≤ - b¬≤y¬≤.\nAchte darauf, erst die Koeffizienten zu quadrieren und zu multiplizieren!"
  };

  // Normalisierung der Eingabe (Leerzeichen weg, ¬≤ -> ^2, f√ºhrendes + weg)
  const norm = s => s
    .replace(/\s+/g,'')
    .replace(/¬≤/g,'^2')
    .replace(/‚àí/g,'-')
    .replace(/^(\+)?/,'')
    .toLowerCase();

  let level = 1;
  const MAX_LEVEL = 3;
  let correctSolution = "";
  let round = 1;
  let score = 0;
  const totalRounds = 10;
  const segments = [];

  function initProgressBar() {
    progressContainer.innerHTML = "";
    segments.length = 0;
    for (let i = 0; i < totalRounds; i++) {
      const seg = document.createElement("div");
      seg.className = "progress-segment";
      seg.style.backgroundColor = "#ddd";
      progressContainer.appendChild(seg);
      segments.push(seg);
    }
  }

  function updateHeader() {
    levelDisplay.innerText = LEVEL_NAMES[level-1];
    scoreEl.innerText = `Aufgabe ${Math.min(round, totalRounds)} von ${totalRounds} ‚Äì Punkte: ${score}`;
  }

  // --- Aufgabengeneratoren ---

  // Level 1: nur Variablen, nur die drei binomischen Formeln
  function createLevel1Task() {
    let a = randomChoice(VARS);
    let b = randomChoice(VARS);
    while (b === a) b = randomChoice(VARS);

    const type = Math.floor(Math.random()*3); // 0: (a+b)¬≤, 1: (a-b)¬≤, 2: (a+b)(a-b)

    if (type === 0) {
      // (a + b)¬≤
      correctSolution = `${a}¬≤+2${a}${b}+${b}¬≤`;
      return `(${a} + ${b})¬≤ = ?`;
    } else if (type === 1) {
      // (a - b)¬≤
      correctSolution = `${a}¬≤-2${a}${b}+${b}¬≤`;
      return `(${a} - ${b})¬≤ = ?`;
    } else {
      // (a + b)(a - b)
      correctSolution = `${a}¬≤-${b}¬≤`;
      return `(${a} + ${b})(${a} - ${b}) = ?`;
    }
  }

  // Level 2: eine Zahl und eine Variable, vertauschte Reihenfolge in der Klammer
  function createLevel2Task() {
    const v = randomChoice(VARS);
    const n = Math.floor(Math.random()*6) + 2; // 2..7
    const type = Math.floor(Math.random()*3); // 0: (x+3)¬≤, 1: (3+x)¬≤, 2: (x+3)(x-3)
    const pm = Math.random() < 0.5 ? "+" : "-";

    if (type === 0) {
      // (v ¬± n)¬≤
      if (pm === "+") {
        correctSolution = `${v}¬≤+${2*n}${v}+${n*n}`;
        return `(${v} + ${n})¬≤ = ?`;
      } else {
        correctSolution = `${v}¬≤-${2*n}${v}+${n*n}`;
        return `(${v} - ${n})¬≤ = ?`;
      }
    } else if (type === 1) {
      // (n ¬± v)¬≤ ‚Äì Reihenfolge vertauscht
      if (pm === "+") {
        correctSolution = `${v}¬≤+${2*n}${v}+${n*n}`;
        return `(${n} + ${v})¬≤ = ?`;
      } else {
        correctSolution = `${v}¬≤-${2*n}${v}+${n*n}`;
        return `(${n} - ${v})¬≤ = ?`;
      }
    } else {
      // (v + n)(v - n)
      correctSolution = `${v}¬≤-${n*n}`;
      return `(${v} + ${n})(${v} - ${n}) = ?`;
    }
  }

  // Level 3: (ax + by)¬≤, (ax - by)¬≤, (ax + by)(ax - by)
  function createLevel3Task() {
    let v1 = randomChoice(VARS);
    let v2 = randomChoice(VARS);
    while (v2 === v1) v2 = randomChoice(VARS);

    const a = Math.floor(Math.random()*4) + 2; // 2..5
    const b = Math.floor(Math.random()*4) + 2; // 2..5
    const type = Math.floor(Math.random()*3); // 0: +¬≤, 1: -¬≤, 2: Produkt

    if (type === 0) {
      // (a v1 + b v2)¬≤
      const a2 = a*a;
      const b2 = b*b;
      const middleCoeff = 2*a*b;
      correctSolution = `${a2}${v1}¬≤+${middleCoeff}${v1}${v2}+${b2}${v2}¬≤`;
      return `(${a}${v1} + ${b}${v2})¬≤ = ?`;
    } else if (type === 1) {
      // (a v1 - b v2)¬≤
      const a2 = a*a;
      const b2 = b*b;
      const middleCoeff = 2*a*b;
      correctSolution = `${a2}${v1}¬≤-${middleCoeff}${v1}${v2}+${b2}${v2}¬≤`;
      return `(${a}${v1} - ${b}${v2})¬≤ = ?`;
    } else {
      // (a v1 + b v2)(a v1 - b v2)
      const a2 = a*a;
      const b2 = b*b;
      correctSolution = `${a2}${v1}¬≤-${b2}${v2}¬≤`;
      return `(${a}${v1} + ${b}${v2})(${a}${v1} - ${b}${v2}) = ?`;
    }
  }

  function finishLevel() {
    resultEl.style.color = "green";
    resultEl.innerHTML = `üéâ Level fertig!<br>Ergebnis: ${score}/${totalRounds}`;

    if (score >= 8 && level < MAX_LEVEL) {
      alert(`Level ${level} geschafft! Weiter mit ${LEVEL_NAMES[level]}.`);
      level++;
    } else if (score >= 8 && level === MAX_LEVEL) {
      alert("üèÜ Alle Level geschafft! Du kannst Level 3 weiter √ºben.");
    } else {
      alert(`Level ${level} beendet mit ${score}/${totalRounds}. Versuch es nochmal!`);
    }

    round = 1;
    score = 0;
    segments.forEach(seg => seg.style.backgroundColor = "#ddd");
    updateHeader();
    newTask();
  }

  function newTask() {
    resultEl.innerText = "";
    answerEl.value = "";

    if (round > totalRounds) {
      finishLevel();
      return;
    }

    updateHeader();

    let aufgabe;
    if (level === 1) aufgabe = createLevel1Task();
    else if (level === 2) aufgabe = createLevel2Task();
    else aufgabe = createLevel3Task();

    taskEl.innerText = aufgabe;
  }

  function checkAnswer() {
    const input = answerEl.value.trim();
    if (!input) {
      resultEl.style.color = "#555";
      resultEl.innerText = "Bitte gib eine L√∂sung ein.";
      return;
    }

    const userNorm = norm(input);
    const solNorm = norm(correctSolution);

    if (userNorm === solNorm) {
      resultEl.style.color = "green";
      resultEl.innerText = "‚úÖ Richtig! (+1 Punkt)";
      score++;
      segments[round-1].style.backgroundColor = "#4caf50";
    } else {
      resultEl.style.color = "#000";
      segments[round-1].style.backgroundColor = "#d9534f";
      const hint = fixedHints[level] || "";
      resultEl.innerHTML =
        `‚ùå Falsch! Richtige L√∂sung: <b>${correctSolution}</b><br><br>` +
        `<b>Hinweis:</b><br>${hint.replace(/\n/g,"<br>")}`;
    }

    round++;
    updateHeader();
  }

  checkBtn.addEventListener("click", checkAnswer);
  newBtn.addEventListener("click", newTask);
  answerEl.addEventListener("keydown", e => {
    if (e.key === "Enter") checkAnswer();
  });

  initProgressBar();
  updateHeader();
  newTask();
});
</script>
</body>
</html>



